/**
 * React Compiler Configuration
 * This configuration file enables the React Compiler with optimized settings
 * for the atoms.tech project.
 */

module.exports = {
  // Enable React Compiler
  enabled: process.env.NODE_ENV === 'production',
  
  // Compilation sources - specify which directories to compile
  sources: (filename) => {
    // Only compile our source files, exclude node_modules and test files
    return (
      filename.includes('src/') &&
      !filename.includes('node_modules') &&
      !filename.includes('.test.') &&
      !filename.includes('.spec.') &&
      !filename.includes('__tests__')
    );
  },

  // Compilation target - optimize for modern browsers in production
  target: '18',

  // Validation settings
  validation: {
    // Enable strict validation in development
    enabled: process.env.NODE_ENV === 'development',
    // Custom validation rules
    rules: {
      'react-hooks/exhaustive-deps': 'warn',
      'react-hooks/rules-of-hooks': 'error',
    }
  },

  // Performance optimizations
  optimizations: {
    // Enable automatic memoization
    autoMemoization: true,
    // Enable constant folding
    constantFolding: true,
    // Enable dead code elimination
    deadCodeElimination: true,
    // Enable inline constants
    inlineConstants: true,
  },

  // Experimental features
  experimental: {
    // Enable experimental optimizations
    optimizeComponents: true,
    // Enable experimental hooks optimization
    optimizeHooks: true,
  },

  // Exclusions - components/files to exclude from compilation
  exclude: [
    // External libraries that don't need compilation
    /node_modules/,
    // Test files
    /\.(test|spec)\.(ts|tsx|js|jsx)$/,
    // Configuration files
    /\.(config|setup)\.(ts|tsx|js|jsx)$/,
    // Story files
    /\.stories\.(ts|tsx|js|jsx)$/,
    // Mock files
    /__mocks__/,
    // Development tools
    /react-scan/,
  ],

  // Debug options (only in development)
  debug: process.env.NODE_ENV === 'development' && {
    // Log compilation statistics
    logStats: true,
    // Save compilation artifacts
    saveArtifacts: false,
    // Verbose logging
    verbose: false,
  },
};